#include <sstream>
#include <cmath>
#include "poly-2b.h" 

////////////////////////////////////////////////////////////////////////////////
namespace x2b {

const unsigned num_linear_params = 222;
const unsigned num_nonlinear_params = 4;
const unsigned num_vars = 6;

const double m_k_OO_intra  = -1.199999998968720e+00; // A^(-1)
const double m_k_CO_intra  = -9.501603308392501e-01; // A^(-1)
const double m_k_AC_inter  =  8.219892004925552e-01; // A^(-1)
const double m_k_AO_inter  =  8.482351084301837e-01; // A^(-1)

const double d0_intra_CO = 1.180200000000000e+00;
const double d0_intra_OO = 2.360500000000000e+00;

const double d0_inter_AO = 4.000000000000000e+00;
const double d0_inter_AC = 4.000000000000000e+00;

inline double var_intra(const double& d0, const double& k, const double& d)
{
    return std::exp(k*(d0 - d));
}

inline double var_inter(const double& d0, const double& k, const double& d)
{
    return std::exp(k*(d0 - d))/d;
}

void cart_to_vars(const double* xyz, double* v, double& s);
double value(const double* xyz); 

const double poly[num_linear_params] = {
 6.837368440975190e-01,-5.217605181314237e-01, 5.646300192730609e-01,-8.182014079566104e-02,-1.467372901324135e+00,
-2.074198109232754e-01,-1.993762870338338e-01,-7.263374099708741e-02,-9.339446008501742e-01,-3.939711160993220e-02,
 3.121518864120560e-01,-7.549565676172992e-02,-1.842966739832827e+00, 1.867385697176153e-01,-3.944844567742351e-01,
-5.329936691871699e-01, 1.374587098655291e-01, 7.319525188121087e-02, 4.522395035980353e-02,-6.183073420148101e-02,
-6.751970204916058e-02,-1.466496378838595e+00,-1.093693393152058e+00, 2.532549306425828e-01, 2.405100063459087e-01,
-9.863300739385415e-02,-2.010421398764379e+00,-3.501516772002928e-01, 2.353285233459473e-01,-1.633106124839034e-02,
 1.569442655451881e+00, 9.107951387143146e-02,-5.567718863294644e-01, 2.572384785219168e-01, 3.789631530556635e+00,
-5.667548378926127e-01,-4.151059786709738e-03,-1.655646034104938e-01,-2.279812768764416e-01,-1.231030950613125e+00,
 3.741881095949996e-01,-9.003898936342335e-02,-1.812336210622806e-01,-1.957090291088716e-01, 8.454092487553155e-02,
 1.053279022167093e-01,-2.598223315684320e-01, 1.148969226000390e+00,-3.472351775249649e-02, 7.405506367146999e-01,
-3.113036186564807e-01,-4.996712420685459e-02, 4.054931010924042e+00,-9.559538745397755e-02, 5.242231822413406e-01,
-2.522384061331332e+00, 1.716975880832866e-01, 4.529095492960900e-02, 1.697664468950598e+00, 1.297958235824144e+00,
 4.993540742276861e-01,-3.686323211911106e+00,-7.341511777431742e-02, 1.558512404577627e+00,-1.087136087045026e-01,
-8.901793502710727e-02,-1.164628783647199e+00, 1.532007733338095e+00, 1.175873389176485e-01,-4.208163380307397e-01,
-3.524166366118937e-01, 2.694297932198966e-01,-4.338030859957549e-01, 1.177798046679152e-01, 1.015094463282800e+00,
-1.086182136159866e+00,-1.256443091483693e+00, 7.118955837040546e-01, 2.206532089675783e-02, 1.943060394452023e+00,
 6.859729505852045e-01, 1.628264730113287e-01, 3.371917404614272e-02, 2.116519891493574e+00,-1.528234597890765e-02,
-2.296065004413017e-01,-2.271416612069009e-01,-1.954713875121213e-01,-5.272462275981943e-02, 1.285508478885706e+00,
 1.073217705579442e-01, 1.774565299032404e-01, 2.210157287724315e-02,-1.768330497834278e+00,-1.381265697858337e+00,
 1.202656677951641e-01, 3.402708517150327e-01,-5.912372620727629e-02,-6.124804034186061e-02,-3.209462733920362e-01,
-5.935743485324978e-01, 1.594538514227861e-01,-1.238426496354871e+00,-5.515294546640346e-01,-4.162126450853305e-01,
-2.986554399217800e-02,-2.277513150716814e-01, 2.847143680724444e-01,-1.864481934659850e+00, 1.913176755061713e+00,
-8.186527469367163e-01, 9.982345839294793e-02,-4.606928703158991e-01, 8.913183920826873e-02,-1.299007901233540e-01,
 5.138498293887254e-01, 3.322399145043916e-01, 2.178732875850486e+00, 3.361494476472042e-01, 2.026566562871409e-01,
-1.849513716523601e-01, 2.264309898207162e-02,-2.302681086443443e-01,-9.517014902435211e-02, 9.274772130336284e-03,
-2.893406196091458e-01,-1.764564716865481e+00, 6.290420449066657e-01,-8.386714019930244e-01, 2.345040321315381e-01,
 1.060886291576849e+00,-5.164416628957194e-01,-2.197369794509341e+00,-3.630882070126875e-01,-5.098178137115910e-01,
-2.936994024144076e-01,-5.600084454820722e-02,-3.368725994247095e+00,-4.482729515920514e-01,-2.430340662629799e-01,
-2.767437046329257e-03,-4.226999260875747e-01,-7.426496291957787e-01, 3.466189361945330e+00, 1.000666662011652e+00,
-9.198694405510947e-01,-1.530398699235637e+00,-3.934638422464385e-01,-1.189678172070228e+00, 6.536627633013503e-01,
-8.169794179802076e-01,-6.259205234189380e-02,-4.760804705847906e-01, 5.570094126696379e+00,-1.137265918144051e-01,
 2.586836390276238e-01,-2.726265601911289e+00, 6.838183672774470e-01, 2.312689031482967e-01, 2.616083226012990e-02,
-3.614047294532835e-02, 4.583044909046929e-01, 1.825398058978690e+00,-1.269369460081587e-01, 8.726445436266508e-03,
-1.043061932835902e-01,-2.543185563171582e-01,-6.234827979431440e-02,-6.768753481434231e-02,-1.104650469579336e+00,
 1.355932096265261e+00,-9.135527942426694e-01, 1.609470756757396e+00,-9.789953371035480e-02, 2.482260358923708e-01,
 1.457194619636086e-01,-1.518331026750635e-01,-1.407478401632721e+00, 7.690180210672865e-01, 7.893716825346564e-03,
 2.214058080798808e-01, 7.263498479877449e-01,-1.688259946418247e-03, 3.831456731269057e-01, 2.285033884109658e-01,
 1.106191441921477e-01, 4.638845789802075e-01, 2.427430769536380e-01,-6.531547450122897e-01, 7.050652845584808e-01,
 1.789973272000979e-01, 7.629616857887669e-01,-8.738710236933145e-02, 1.020346149359189e+00,-4.661691558490050e-02,
-2.814020031690935e+00,-6.471972211893766e-01, 1.237701711405651e+00,-1.317216341752528e+00, 7.834474347088441e-02,
 1.147331967047124e+00,-9.672242273065151e-01, 9.428925690783719e-01, 2.053450659406327e-01,-1.304045604247146e-01,
-8.755880580046065e-02, 3.585618574077882e-01, 1.955350288161110e+00, 2.930830041216073e-01,-3.496800420154154e-01,
-2.031760585022501e-01, 2.083093928678581e+00, 8.037544294368141e-01,-4.725780489367551e-01, 1.824778066951174e-01,
 8.944480987585612e-01,-1.891403622381755e-01,-9.422170287763221e-01,-2.818910256654814e-02,-1.530611702983189e+00,
 4.020679521428440e-01,-5.868574859860319e-01};
} // namespace x2b

////////////////////////////////////////////////////////////////////////////////
